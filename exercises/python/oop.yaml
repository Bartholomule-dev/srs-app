# exercises/python/oop.yaml
language: python
category: oop

exercises:
  - slug: define-class
    objective: Define a basic class using the class keyword syntax
    title: Define Class
    difficulty: 2
    prompt: Define a class called {{entity_name}}
    expected_answer: "class {{entity_name}}:"
    hints:
      - Use the class keyword
      - Class names conventionally use PascalCase
    tags: [classes, oop, intermediate]
    concept: oop
    subconcept: classes
    level: intro
    prereqs: [functions]
    type: write
    pattern: definition

  - slug: init-method
    objective: Define an __init__ constructor method with self and parameters
    title: Init Method
    difficulty: 2
    prompt: Define __init__ that takes self and {{attr_key_1}} parameter
    expected_answer: "def __init__(self, {{attr_key_1}}):"
    hints:
      - Use double underscores
      - self is always first parameter
    tags: [classes, init, intermediate]
    concept: oop
    subconcept: methods
    level: intro
    prereqs: [functions]
    type: write
    pattern: definition

  - slug: instance-attribute
    objective: Assign a value to an instance attribute using self.attribute syntax
    title: Instance Attribute
    difficulty: 2
    prompt: Set self.{{attr_key_1}} to the {{attr_key_1}} parameter inside __init__
    expected_answer: "self.{{attr_key_1}} = {{attr_key_1}}"
    hints:
      - Use self.attribute = value
      - This makes the attribute accessible on the object
    tags: [classes, attributes, intermediate]
    concept: oop
    subconcept: classes
    level: intro
    prereqs: [functions]
    type: write
    pattern: construction

  - slug: instance-method
    objective: Define an instance method that takes self as the first parameter
    title: Instance Method
    difficulty: 2
    prompt: Define a method called {{action_verb}} that takes self
    expected_answer: "def {{action_verb}}(self):"
    hints:
      - Methods always take self as first parameter
      - self gives access to the instance's attributes
    tags: [classes, methods, intermediate]
    concept: oop
    subconcept: methods
    level: intro
    prereqs: [functions]
    type: write
    pattern: definition

  # --- Inheritance Subconcept ---
  - slug: inheritance-basic
    objective: Create a subclass that inherits from a parent class
    title: Basic Inheritance
    difficulty: 2
    concept: oop
    subconcept: inheritance
    level: intro
    prereqs: [oop.classes]
    type: write
    pattern: definition
    prompt: Define class Special{{entity_name}} that inherits from {{entity_name}}
    expected_answer: "class Special{{entity_name}}({{entity_name}}):"
    hints:
      - Put parent class in parentheses
      - Special{{entity_name}} will inherit all methods from {{entity_name}}
    tags: [oop, inheritance, beginner]

  - slug: inheritance-super-init
    objective: Call the parent class constructor using super()
    title: Super Init
    difficulty: 2
    concept: oop
    subconcept: inheritance
    level: intro
    prereqs: [oop.inheritance]
    type: write
    pattern: invocation
    prompt: Call the parent class __init__ with {{attr_key_1}} parameter using super()
    expected_answer: "super().__init__({{attr_key_1}})"
    hints:
      - Use super() to access parent
      - Call __init__ like a method
    tags: [oop, inheritance, super]

  - slug: inheritance-override-method
    objective: Override a parent class method in a subclass
    title: Method Override
    difficulty: 2
    concept: oop
    subconcept: inheritance
    level: practice
    prereqs: [oop.inheritance]
    type: write
    pattern: definition
    prompt: Define a {{action_verb}} method in a subclass that overrides the parent's {{action_verb}}
    expected_answer: "def {{action_verb}}(self):"
    hints:
      - Same method name overrides parent
      - The subclass version is called instead
    tags: [oop, inheritance, override]

  - slug: inheritance-super-method
    objective: Extend a parent method by calling super() within the override
    title: Extend Parent Method
    difficulty: 3
    concept: oop
    subconcept: inheritance
    level: practice
    prereqs: [oop.inheritance]
    type: write
    pattern: invocation
    prompt: Call the parent's {{action_verb}} method from within an overriding {{action_verb}} method
    expected_answer: "super().{{action_verb}}()"
    hints:
      - Use super() to access parent method
      - This lets you extend the parent's behavior rather than replace it
    tags: [oop, inheritance, super]

  - slug: inheritance-isinstance
    objective: Check if an object is an instance of a class or its subclasses
    title: Check Inheritance
    difficulty: 2
    concept: oop
    subconcept: inheritance
    level: practice
    prereqs: [oop.inheritance]
    type: write
    pattern: invocation
    prompt: Check if {{item_singular}} is an instance of {{entity_name}} (including subclasses)
    expected_answer: "isinstance({{item_singular}}, {{entity_name}})"
    hints:
      - isinstance checks inheritance chain
      - Returns True if object is {{entity_name}} or any subclass
    tags: [oop, inheritance, isinstance]

  - slug: inheritance-issubclass
    objective: Check if a class is a subclass of another class
    title: Check Subclass
    difficulty: 2
    concept: oop
    subconcept: inheritance
    level: edge
    prereqs: [oop.inheritance]
    type: write
    pattern: invocation
    prompt: Check if Special{{entity_name}} is a subclass of {{entity_name}}
    expected_answer: "issubclass(Special{{entity_name}}, {{entity_name}})"
    hints:
      - issubclass checks class hierarchy
      - Takes class names, not instances
    tags: [oop, inheritance, issubclass]

  # --- Classmethod Subconcept ---
  - slug: classmethod-basic
    objective: Define a class method using the @classmethod decorator
    title: Basic Classmethod
    difficulty: 2
    concept: oop
    subconcept: classmethod
    level: intro
    prereqs: [oop.methods]
    type: write
    pattern: definition
    prompt: Write the decorator and signature for a class method called create_{{item_singular}} (just the header, no body)
    expected_answer: |
      @classmethod
      def create_{{item_singular}}(cls):
    accepted_solutions:
      - |
        @classmethod
        def create_{{item_singular}}(cls):
      - "@classmethod\ndef create_{{item_singular}}(cls):"
    hints:
      - Use @classmethod decorator on the line before def
      - First parameter is cls, not self
    tags: [oop, classmethod, decorator]

  - slug: classmethod-cls-parameter
    objective: Use cls parameter to access class attributes
    title: Cls Parameter
    difficulty: 2
    concept: oop
    subconcept: classmethod
    level: intro
    prereqs: [oop.classmethod]
    type: write
    pattern: invocation
    prompt: Return cls.{{item_singular}}_count from within a classmethod
    expected_answer: "return cls.{{item_singular}}_count"
    hints:
      - cls refers to the class itself
      - Access class attributes with cls.attribute_name
    tags: [oop, classmethod, cls]

  - slug: classmethod-factory
    objective: Create an alternative constructor using a classmethod
    title: Factory Method
    difficulty: 3
    concept: oop
    subconcept: classmethod
    level: practice
    prereqs: [oop.classmethod]
    type: write
    pattern: definition
    prompt: Define a classmethod from_string that creates an instance from a string
    expected_answer: |
      @classmethod
      def from_string(cls, s):
          return cls(s)
    hints:
      - Call cls() to create new instance
      - Parse the string and pass to constructor
    tags: [oop, classmethod, factory]

  - slug: classmethod-call
    objective: Call a classmethod on the class itself
    title: Call Classmethod
    difficulty: 2
    concept: oop
    subconcept: classmethod
    level: practice
    prereqs: [oop.classmethod]
    type: write
    pattern: invocation
    prompt: Call the from_string classmethod on {{entity_name}} class with "{{item_example}}"
    expected_answer: '{{entity_name}}.from_string("{{item_example}}")'
    accepted_solutions:
      - '{{entity_name}}.from_string("{{item_example}}")'
      - "{{entity_name}}.from_string('{{item_example}}')"
    hints:
      - Call on the class, not an instance
      - Classmethods can also be called on instances, but calling on the class is clearer
    tags: [oop, classmethod, call]

  - slug: staticmethod-basic
    objective: Define a static method using the @staticmethod decorator
    title: Basic Staticmethod
    difficulty: 2
    concept: oop
    subconcept: classmethod
    level: practice
    prereqs: [oop.methods]
    type: write
    pattern: definition
    prompt: Define a static method called validate_{{item_singular}} using @staticmethod decorator
    expected_answer: |
      @staticmethod
      def validate_{{item_singular}}(value):
    hints:
      - Use @staticmethod decorator
      - No self or cls parameter
    tags: [oop, staticmethod, decorator]

  - slug: staticmethod-vs-classmethod
    objective: Choose between staticmethod and classmethod based on need for class access
    title: Static vs Class Method
    difficulty: 3
    concept: oop
    subconcept: classmethod
    level: edge
    prereqs: [oop.classmethod]
    type: write
    pattern: definition
    prompt: Define a utility method is_valid_{{item_singular}} that doesn't need self or cls
    expected_answer: |
      @staticmethod
      def is_valid_{{item_singular}}(value):
    hints:
      - staticmethod when you don't need class access
      - classmethod when you need cls
    tags: [oop, staticmethod, classmethod]

  # --- Properties Subconcept ---
  - slug: property-getter
    objective: Define a property getter using the @property decorator
    title: Property Getter
    difficulty: 2
    concept: oop
    subconcept: properties
    level: intro
    prereqs: [oop.methods]
    type: write
    pattern: definition
    prompt: Define a property called {{item_singular}}_display using @property decorator
    expected_answer: |
      @property
      def {{item_singular}}_display(self):
    hints:
      - Use @property decorator
      - Method becomes readable as attribute
    tags: [oop, property, getter]

  - slug: property-return
    objective: Return a computed value from a property getter
    title: Property Return Value
    difficulty: 2
    concept: oop
    subconcept: properties
    level: intro
    prereqs: [oop.properties]
    type: write
    pattern: construction
    prompt: Return {{attr_key_1}} and {{attr_key_2}} joined with a space from a {{item_singular}} property
    expected_answer: return f"{self.{{attr_key_1}}} {self.{{attr_key_2}}}"
    accepted_solutions:
      - 'return f"{self.{{attr_key_1}}} {self.{{attr_key_2}}}"'
      - "return f'{self.{{attr_key_1}}} {self.{{attr_key_2}}}'"
      - "return self.{{attr_key_1}} + ' ' + self.{{attr_key_2}}"
    hints:
      - Combine the two {{item_singular}} attributes
      - Use f-string or string concatenation with a space
    tags: [oop, property, computed]

  - slug: property-setter
    objective: Define a property setter using the @name.setter decorator
    title: Property Setter
    difficulty: 2
    concept: oop
    subconcept: properties
    level: practice
    prereqs: [oop.properties]
    type: write
    pattern: definition
    prompt: Define a setter for the {{item_singular}}_display property
    expected_answer: |
      @{{item_singular}}_display.setter
      def {{item_singular}}_display(self, value):
    hints:
      - Use @property_name.setter
      - Same method name as getter
    tags: [oop, property, setter]

  - slug: property-setter-validation
    objective: Add validation logic inside a property setter
    title: Property Validation
    difficulty: 3
    concept: oop
    subconcept: properties
    level: practice
    prereqs: [oop.properties]
    type: write
    pattern: handling
    prompt: In a {{item_singular}} setter, raise ValueError if {{attr_key_1}} is negative
    expected_answer: |
      if {{attr_key_1}} < 0:
          raise ValueError("{{attr_key_1}} cannot be negative")
    accepted_solutions:
      - |
        if {{attr_key_1}} < 0:
            raise ValueError("{{attr_key_1}} cannot be negative")
      - |
        if {{attr_key_1}} < 0:
            raise ValueError('{{attr_key_1}} cannot be negative')
    hints:
      - Check {{item_singular}} condition before setting
      - Raise appropriate {{item_singular}} exception
    tags: [oop, property, validation]

  - slug: property-deleter
    objective: Define a property deleter using the @name.deleter decorator
    title: Property Deleter
    difficulty: 3
    concept: oop
    subconcept: properties
    level: edge
    prereqs: [oop.properties]
    type: write
    pattern: definition
    prompt: Define a deleter for the {{item_singular}} property
    expected_answer: |
      @{{item_singular}}.deleter
      def {{item_singular}}(self):
    hints:
      - Use @property_name.deleter
      - Called when del obj.{{item_singular}} is used
    tags: [oop, property, deleter]

  - slug: property-readonly
    objective: Create a read-only property by defining only a getter
    title: Read-Only Property
    difficulty: 2
    concept: oop
    subconcept: properties
    level: edge
    prereqs: [oop.properties]
    type: write
    pattern: definition
    prompt: Define a read-only property called {{attr_key_1}} that returns self._{{attr_key_1}}
    expected_answer: |
      @property
      def {{attr_key_1}}(self):
          return self._{{attr_key_1}}
    hints:
      - Only define getter, no setter
      - Use underscore prefix for private attribute
    tags: [oop, property, readonly]

  # --- Fill-in Exercises ---
  - slug: class-keyword-fill
    objective: Complete the class definition keyword
    title: Class Keyword Fill-in
    difficulty: 1
    concept: oop
    subconcept: classes
    level: intro
    prereqs: []
    type: fill-in
    blank_position: 0
    pattern: definition
    prompt: Fill in the keyword that defines a {{item_singular}} class
    template: "___ {{entity_name}}:"
    expected_answer: "class"
    hints:
      - Keyword that starts {{item_singular}} class definition
      - Similar to how 'def' starts a {{item_singular}} function
    tags: [oop, class, fill-in]

  - slug: init-self-fill
    objective: Complete the __init__ first parameter
    title: Init Self Fill-in
    difficulty: 1
    concept: oop
    subconcept: methods
    level: intro
    prereqs: [oop.classes]
    type: fill-in
    blank_position: 0
    pattern: definition
    prompt: Fill in the first parameter that refers to the {{item_singular}} instance
    template: "def __init__(___, {{attr_key_1}}):"
    expected_answer: "self"
    hints:
      - Always the first parameter in {{item_singular}} instance methods
      - Refers to the {{item_singular}} object being created
    tags: [oop, init, fill-in]

  - slug: super-fill
    objective: Complete the super() call
    title: Super Fill-in
    difficulty: 2
    concept: oop
    subconcept: inheritance
    level: practice
    prereqs: [oop.inheritance]
    type: fill-in
    blank_position: 0
    pattern: invocation
    prompt: Fill in the function that accesses the parent {{item_singular}} class
    template: "___().__init__({{attr_key_1}})"
    expected_answer: "super"
    hints:
      - Built-in to access parent {{item_singular}} class
      - Returns a proxy object for accessing parent {{item_singular}} methods
    tags: [oop, super, fill-in]

  # --- Predict Exercises ---
  - slug: instance-attribute-predict
    objective: Predict instance attribute access
    title: Instance Attribute Predict
    difficulty: 2
    concept: oop
    subconcept: classes
    level: intro
    prereqs: [oop.classes]
    type: predict
    pattern: invocation
    generator: oop-instance
    prompt: What does this code print?
    code: |
      class Person:
          def __init__(self, name):
              self.name = name
      p = Person("{{personName}}")
      print(p.name)
    expected_answer: "{{personName}}"
    hints:
      - self.name stores the passed value
      - Accessing p.name retrieves what was set in __init__
    tags: [oop, attribute, predict, dynamic]

  - slug: method-call-predict
    objective: Predict method return value
    title: Method Call Predict
    difficulty: 2
    concept: oop
    subconcept: methods
    level: practice
    prereqs: [oop.methods]
    type: predict
    pattern: invocation
    prompt: What does this counter method code print?
    code: |
      class {{entity_name}}Counter:
          def __init__(self):
              self.{{item_singular}}_count = 0
          def {{action_verb}}(self):
              self.{{item_singular}}_count += 1
              return self.{{item_singular}}_count
      c = {{entity_name}}Counter()
      print(c.{{action_verb}}())
      print(c.{{action_verb}}())
    expected_answer: |
      1
      2
    hints:
      - Each {{action_verb}} call increments and returns {{item_singular}} count
      - The {{item_singular}} object remembers its state between method calls
    tags: [oop, method, predict]

  - slug: inheritance-predict
    objective: Predict inherited method behavior
    title: Inheritance Predict
    difficulty: 2
    concept: oop
    subconcept: inheritance
    level: practice
    prereqs: [oop.inheritance]
    type: predict
    pattern: invocation
    prompt: What does this inheritance override print?
    code: |
      class {{entity_name}}:
          def {{action_verb}}(self):
              return "{{status_var}}"
      class Special{{entity_name}}({{entity_name}}):
          def {{action_verb}}(self):
              return "{{item_example}}"
      obj = Special{{entity_name}}()
      print(obj.{{action_verb}}())
    expected_answer: "{{item_example}}"
    hints:
      - Child {{item_singular}} method overrides parent
      - Python uses the most specific (child) {{item_singular}} implementation
    tags: [oop, inheritance, predict]

  # --- Dynamic OOP Exercises ---
  - slug: method-call-dynamic
    objective: Predict the result of calling a method on an object
    title: Dynamic Method Call
    difficulty: 2
    concept: oop
    subconcept: methods
    level: practice
    prereqs: [oop.methods]
    type: predict
    pattern: invocation
    generator: class-method
    prompt: "What does this code print?"
    code: "{{code}}"
    expected_answer: "{{result}}"
    hints:
      - "The {{method}} method modifies or returns based on {{attribute}}"
      - "Context: {{context}}"
    tags: [oop, methods, dynamic, predict]

  - slug: instance-method-write-dynamic
    objective: Write a method call on an instance
    title: Dynamic Instance Method Write
    difficulty: 2
    concept: oop
    subconcept: methods
    level: practice
    prereqs: [oop.methods]
    type: write
    pattern: invocation
    generator: class-method
    prompt: "Given obj is a {{className}} instance, call its {{method}} method"
    expected_answer: "{{methodCall}}"
    hints:
      - "Call methods using dot notation: obj.method()"
      - "Don't forget the parentheses at the end"
    tags: [oop, methods, dynamic, write]

  # --- Inheritance Dynamic Exercises ---
  - slug: inheritance-predict-dynamic
    objective: Predict the output when calling a method on a child class
    title: Dynamic Inheritance Method
    difficulty: 3
    concept: oop
    subconcept: inheritance
    level: practice
    prereqs: [oop.inheritance]
    type: predict
    pattern: invocation
    generator: inheritance-method
    prompt: "What does this code print?"
    code: "{{code}}"
    expected_answer: "{{result}}"
    hints:
      - "{{description}}"
      - "Check if {{childClass}} overrides {{method}}"
    tags: [oop, inheritance, dynamic, predict]

  - slug: inheritance-override-dynamic
    objective: Identify which class provides the method implementation
    title: Dynamic Method Resolution
    difficulty: 3
    concept: oop
    subconcept: inheritance
    level: practice
    prereqs: [oop.inheritance]
    type: predict
    pattern: invocation
    generator: inheritance-method
    prompt: "When calling {{method}}() on a {{callOn}} instance, which class provides the implementation? ({{parentClass}} or {{childClass}})"
    code: "{{code}}"
    expected_answer: "{{callOn}}"
    hints:
      - "Check if the child class overrides the method"
      - "If no override, the parent's method is used"
    tags: [oop, inheritance, dynamic, predict]

  # --- Integrated Exercises (Premium - Combining Multiple Subconcepts) ---
  - slug: api-response-model-integrated
    objective: Build an API response dataclass with safe mutable defaults
    title: API Response Model
    difficulty: 3
    concept: oop
    subconcept: dataclasses
    level: integrated
    prereqs: [dataclasses, typehints, mutability, defaults]
    targets: [dataclasses, typehints, mutability, defaults]
    type: write
    pattern: definition
    domains: [web]
    prompt: |
      Define a @dataclass named {{entity_name}}Response with:
      - {{status_var}}: int defaulting to 200
      - {{item_plural}}: list[str] using field(default_factory=list) to avoid shared state
      Import field from dataclasses.
    expected_answer: |
      @dataclass
      class {{entity_name}}Response:
          {{status_var}}: int = 200
          {{item_plural}}: list[str] = field(default_factory=list)
    accepted_solutions:
      - |
        @dataclass
        class {{entity_name}}Response:
            {{status_var}}: int = 200
            {{item_plural}}: list[str] = field(default_factory=list)
    hints:
      - Use @dataclass decorator for {{item_singular}}
      - Mutable {{item_plural}} defaults need field(default_factory=...)
      - This prevents shared {{item_singular}} state bugs
    tags: [dataclass, api, mutable-default, integrated]

  - slug: health-check-dataclass-integrated
    objective: Create a health check dataclass with f-string log method
    title: Health Check with Logging
    difficulty: 3
    concept: oop
    subconcept: dataclasses
    level: integrated
    prereqs: [dataclasses, fstrings, methods, defaults]
    targets: [dataclasses, fstrings, methods, defaults]
    type: write
    pattern: definition
    prompt: |
      Define a @dataclass {{entity_name}}Check with:
      - {{attr_key_1}}: str
      - {{status_var}}: str = "ok"
      - {{attr_key_2}}_ms: int = 0
      Add method to_log_line() returning f"{self.{{attr_key_1}}}:{self.{{status_var}}} ({self.{{attr_key_2}}_ms}ms)"
    expected_answer: |
      @dataclass
      class {{entity_name}}Check:
          {{attr_key_1}}: str
          {{status_var}}: str = "ok"
          {{attr_key_2}}_ms: int = 0

          def to_log_line(self) -> str:
              return f"{self.{{attr_key_1}}}:{self.{{status_var}}} ({self.{{attr_key_2}}_ms}ms)"
    hints:
      - Methods work normally in {{item_singular}} dataclasses
      - Use f-string for formatted {{item_singular}} output
      - Access {{item_singular}} fields with self.fieldname
    tags: [dataclass, logging, fstring, integrated]

  # --- Debug Exercises (Pitfall Subconcepts) ---